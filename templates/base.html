{% load humanize static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        {% include "partials/_head.html" %}
        {% block extra_head %}
            <script>
    (function () {
      try {
        const KEY = 'adminlte-theme';
        const saved = localStorage.getItem(KEY);
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = saved || (prefersDark ? 'dark' : 'light');

        const html = document.documentElement;
        const body = document.body;

        // AdminLTE v3: use .dark-mode on <body>
        if (theme === 'dark') {
          body && body.classList && body.classList.add('dark-mode');
        } else {
          body && body.classList && body.classList.remove('dark-mode');
        }

        // AdminLTE v4 (Bootstrap 5): use data-bs-theme on <html>
        html.setAttribute('data-bs-theme', theme);
      } catch (e) { /* ignore */ }
    })();
            </script>
        {% endblock %}
    </head>
    <body class="hold-transition sidebar-mini layout-fixed layout-footer-fixed">
        <div class="wrapper">
            {# Top Navbar #}
            {% include "partials/_navbar.html" %}
            {# Sidebar #}
            {% include "partials/_sidebar.html" %}
            {# Content Wrapper #}
            <div class="content-wrapper">
                <section class="content-header">
                    <div class="container-fluid">
                        {% block breadcrumbs %}
                            {% include "partials/_breadcrumbs.html" %}
                        {% endblock %}
                    </div>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        {# Flash messages #}
                        {% include "partials/_messages.html" %}
                        {% block content %}{% endblock %}
                    </div>
                </section>
            </div>
            {# Footer #}
            {% include "partials/_footer.html" %}
        </div>
        {# Core JS #}
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
        {% block extra_js %}
            <script>
document.addEventListener("DOMContentLoaded", function () {
    const toggleBtn = document.getElementById("themeToggle");
    const icon = document.getElementById("themeIcon");

    // Check saved theme (default to light if not set)
    const savedTheme = localStorage.getItem("theme") || "light";

    if (savedTheme === "dark") {
        document.body.classList.add("dark-mode");
        icon.classList.replace("fa-moon", "fa-sun");
    } else {
        document.body.classList.remove("dark-mode");
        icon.classList.replace("fa-sun", "fa-moon");
    }

    toggleBtn.addEventListener("click", function (e) {
        e.preventDefault();
        document.body.classList.toggle("dark-mode");

        if (document.body.classList.contains("dark-mode")) {
            icon.classList.replace("fa-moon", "fa-sun");
            localStorage.setItem("theme", "dark");
        } else {
            icon.classList.replace("fa-sun", "fa-moon");
            localStorage.setItem("theme", "light");
        }
    });
});
            </script>
        {% endblock %}
    </body>
</html>
